# Castle Game Engine - Empty Project

## Project Creation

This project was scaffolded using:

```bash
castle-engine create empty
```

This generates an "empty" template with a basic TCastleView, FPS label, and the standard project structure.

## Project Structure

- `CastleEngineManifest.xml` - Project manifest (name, version, build settings)
- `code/gameinitialize.pas` - Application initialization (creates window, loads settings, sets initial view)
- `code/gameviewmain.pas` - Main view with Update/Press handlers and FPS label
- `data/gameviewmain.castle-user-interface` - JSON design file defining the UI/3D scene
- `data/CastleSettings.xml` - Container settings (UI scaling, default font)
- `empty_standalone.dpr` - Delphi project file (standalone build entry point)
- `empty_standalone.lpi` - Lazarus project file
- `castleautogenerated.pas` - Auto-generated unit (do not edit manually)
- `generate_castle_glb.py` - Python script that procedurally generates `data/castle.glb`
- `data/castle.glb` - Generated medieval castle model (glTF binary)

## 3D Scene Setup

The design file (`data/gameviewmain.castle-user-interface`) contains:

- **TCastleViewport** (full-size) - The 3D viewport
  - **TCastleWalkNavigation** - First-person movement with WASD keys and mouse look (child of viewport)
- Inside viewport Items (TCastleRootTransform):
  - **TCastleCamera** at Y=1.8 (eye level)
  - **TCastlePlane** (100x100, green) - Ground to walk on
  - **TCastleBox** x3 - Colored box landmarks
  - **TCastleDirectionalLight** - Scene lighting
  - **TCastleScene** loading `castle-data:/castle.glb` - Procedural medieval castle
- **TCastleLabel** - FPS counter (top-right corner)

## Building and Running

Build (compile):
```bash
castle-engine compile
```

Run (compiles if needed, then runs):
```bash
castle-engine run
```

Clean build artifacts:
```bash
castle-engine clean
```

## Controls

- **WASD** - Move forward/backward/strafe left/right
- **Mouse** - Look around (click on window first to capture mouse)
- **Escape** - Release mouse / exit

## What the Project Has

- A green ground plane (100x100) you can walk on
- Three colored box primitives as landmarks
- A procedural medieval castle (loaded from `data/castle.glb`):
  - 4 corner towers (cylindrical, radius 3m, height 12m) with crenellations
  - 4 connecting walls (height 8m) with battlements
  - Central keep (8x16x8m) with turret on top
  - Gatehouse with flanking pillars and lintel on the south wall
  - Procedural stone texture (512x512, running bond pattern with color variation)
  - PBR material (non-metallic, rough stone)
  - ~3058 vertices, ~1600 triangles
- First-person walk navigation (TCastleWalkNavigation, move speed 10)
- Camera starts at Z=30 (outside the castle, facing it)
- Directional light illuminating the scene
- FPS counter label in the top-right corner

## Regenerating the Castle Model

To regenerate `data/castle.glb` after modifying `generate_castle_glb.py`:
```bash
python3 generate_castle_glb.py
```
The script uses Pillow and standard library modules (struct, json, math, random).

## How This Project Was Created

1. Scaffolded with `castle-engine create empty` which generates the template with TCastleView, FPS label, and standard project structure
2. Edited `data/gameviewmain.castle-user-interface` (JSON design file) to add the 3D viewport with TCastleWalkNavigation, TCastlePlane ground, three TCastleBox landmarks, TCastleCamera at eye level, and TCastleDirectionalLight
3. The Pascal code (`code/gameviewmain.pas`) was kept as-is from the template â€” it loads the design file and updates the FPS label each frame
4. Compiled with `castle-engine compile` and verified working with `castle-engine run`
